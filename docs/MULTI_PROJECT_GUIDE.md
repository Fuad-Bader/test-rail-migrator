# Multi-Project Migration Guide

## Overview

The TestRail to Xray migrator now supports selecting specific projects to migrate, allowing you to:

- Choose which TestRail project to import (instead of importing all projects)
- Select which Jira project to migrate to (or create a new one)
- Migrate multiple TestRail projects to different Jira projects

## Quick Start

### 1. Interactive Project Selection

Run the project selector tool:

```bash
python3 project_selector.py
```

This interactive tool will guide you through:

1. **Selecting a TestRail project** from all available projects
2. **Selecting or creating a Jira project** as the migration target
3. **Saving the configuration** for the next steps

### 2. Import Selected Project

Once you've selected your projects, import the TestRail data:

```bash
python3 importer.py
```

This will:

- Import ONLY the selected TestRail project
- Store data in `testrail.db`
- Download attachments to `attachments/`

### 3. Migrate to Jira

Finally, run the migration:

```bash
python3 migrator.py
```

This will migrate the imported TestRail project to the selected Jira project.

## Features

### Project Selection

The project selector displays:

- All available TestRail projects with their status (Active/Completed)
- All existing Jira projects with their keys
- Option to create a new Jira project

**Example Selection:**

```text
Available TestRail Projects:

  1. Mobile App Testing (ID: 1) - âœ“ Active
  2. Web Portal Tests (ID: 2) - âœ“ Active
  3. API Test Suite (ID: 3) - âœ“ Active

Select project (1-3): 2
âœ“ Selected: Web Portal Tests

Available Jira Projects:

  1. Mobile Testing (MT)
  2. Web Testing (WT)
  3. Create new project

Select project (1-3): 3
```

### Jira Project Creation

When creating a new Jira project, you'll be prompted for:

1. **Project Key** (2-10 uppercase letters, e.g., 'WEBTEST')
2. **Project Name** (e.g., 'Web Portal Testing')
3. **Project Description** (optional)
4. **Project Template** (Scrum, Kanban, or Basic)

**Example:**

```text
Enter project key: WEBTEST
Enter project name: Web Portal Testing
Enter project description (optional): Migration from TestRail Web Portal Tests

Project Templates:
  1. Scrum software development
  2. Kanban software development
  3. Basic software development

Select template (1-3) [default: 1]: 1

Creating project 'Web Portal Testing' (WEBTEST)...
âœ“ Project created successfully!
```

### Configuration File

The tool creates `migration_config.json`:

```json
{
  "testrail_project_id": 2,
  "testrail_project_name": "Web Portal Tests",
  "jira_project_key": "WEBTEST",
  "jira_project_name": "Web Portal Testing"
}
```

This file is used by both `importer.py` and `migrator.py` to ensure consistency.

## Migrating Multiple Projects

To migrate multiple TestRail projects to different Jira projects:

### Option 1: Sequential Migration (Recommended)

Migrate one project completely before starting the next:

```bash
# Project 1
python3 project_selector.py  # Select Project 1 â†’ Jira Project A
python3 importer.py           # Import Project 1
python3 migrator.py           # Migrate to Jira Project A

# Project 2
python3 project_selector.py  # Select Project 2 â†’ Jira Project B
python3 importer.py           # Import Project 2 (overwrites testrail.db)
python3 migrator.py           # Migrate to Jira Project B

# Continue for additional projects...
```

**Note:** Each import overwrites `testrail.db`, so complete the full migration cycle before starting a new project.

### Option 2: Backup Database Between Projects

If you want to preserve imported data:

```bash
# Project 1
python3 project_selector.py
python3 importer.py
python3 migrator.py
mv testrail.db testrail_project1.db  # Backup database
mv migration_config.json migration_config_project1.json

# Project 2
python3 project_selector.py
python3 importer.py
python3 migrator.py
mv testrail.db testrail_project2.db  # Backup database
mv migration_config.json migration_config_project2.json
```

## Configuration

### Required Configuration Files

**config.json** (credentials only):

```json
{
  "testrail_url": "https://your-instance.testrail.io/",
  "testrail_user": "your-email@company.com",
  "testrail_password": "your-testrail-password",

  "jira_url": "https://your-jira-instance.com",
  "jira_username": "your-jira-email@company.com",
  "jira_password": "your-jira-api-token"
}
```

**migration_config.json** (generated by project_selector.py):

```json
{
  "testrail_project_id": 2,
  "testrail_project_name": "Web Portal Tests",
  "jira_project_key": "WEBTEST",
  "jira_project_name": "Web Portal Testing"
}
```

## Authentication

### TestRail

Use your TestRail email and password.

### Jira

- **Jira Cloud**: Use email + API token
  - Generate token at: <https://id.atlassian.com/manage-profile/security/api-tokens>
- **Jira Server/Data Center**: Use username + password or PAT

The tool automatically detects the authentication type.

## Workflow Diagram

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  project_selector.py    â”‚
â”‚  - List TestRail projects
â”‚  - List/Create Jira projects
â”‚  - Save configuration  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  migration_config.json  â”‚
â”‚  - testrail_project_id  â”‚
â”‚  - jira_project_key     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     importer.py         â”‚
â”‚  - Fetch selected project
â”‚  - Store in testrail.dbâ”‚
â”‚  - Download attachments â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     migrator.py         â”‚
â”‚  - Read testrail.db     â”‚
â”‚  - Migrate to Jira      â”‚
â”‚  - Update test results  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Troubleshooting

### Error: "migration_config.json not found"

**Solution:** Run `python3 project_selector.py` first to select projects.

### Error: "Could not fetch TestRail projects"

**Solution:** Check your TestRail credentials in `config.json`.

### Error: "Could not fetch Jira projects"

**Solution:** Verify your Jira credentials and ensure you have permission to view projects.

### Error: "Project creation failed"

**Possible causes:**

- Project key already exists
- Insufficient permissions
- Invalid project key format (must be 2-10 uppercase letters)

**Solution:** Try a different project key or check your Jira permissions.

### Warning: "No TestRail project selected. Exiting."

This occurs if you:

- Press Ctrl+C during selection
- Enter an empty value
- Enter an invalid selection

**Solution:** Run `project_selector.py` again and make a valid selection.

## Tips

1. **Test on a small project first** - Verify the workflow works before migrating large projects
2. **Complete one migration at a time** - Don't start a new project selection until the previous migration is complete
3. **Keep backups** - Save `migration_config.json` and `testrail.db` for each project if needed
4. **Document your mappings** - Keep track of which TestRail projects map to which Jira projects
5. **Verify before proceeding** - Always check the confirmation screen before starting import/migration

## Example Complete Workflow

```bash
# Step 1: Configure credentials
nano config.json  # Add your TestRail and Jira credentials

# Step 2: Select projects
python3 project_selector.py

# Output will show:
# - TestRail projects list
# - Jira projects list (or create new)
# - Confirmation screen
# - Saved configuration

# Step 3: Import TestRail data
python3 importer.py

# Output will show:
# - Selected project name
# - Progress bars for each entity type
# - Summary of imported data

# Step 4: Migrate to Jira
python3 migrator.py

# Output will show:
# - Target Jira project
# - Migration progress
# - Success/failure for each item
# - Final summary

# Step 5: Verify in Jira
# - Open your Jira project
# - Check that tests, test sets, and test executions were created
# - Verify test results are correct
```

## Advanced Usage

### Script the Selection Process

For automation, you can pre-create `migration_config.json`:

```json
{
  "testrail_project_id": 5,
  "testrail_project_name": "API Test Suite",
  "jira_project_key": "API",
  "jira_project_name": "API Testing"
}
```

Then run:

```bash
python3 importer.py && python3 migrator.py
```

### Custom Project Mappings

Edit `migration_config.json` directly if needed, ensuring:

- `testrail_project_id` matches an existing TestRail project
- `jira_project_key` matches an existing (or newly created) Jira project

## Benefits of Multi-Project Support

1. **Selective Migration** - Only migrate what you need
2. **Project Isolation** - Keep different test projects separate in Jira
3. **Incremental Migration** - Migrate projects one at a time
4. **Flexibility** - Create new Jira projects or reuse existing ones
5. **Control** - Review and confirm before each migration

## Next Steps

After successful migration:

1. **Verify data** in Jira/Xray
2. **Train team members** on the new Jira project
3. **Update test automation** to use new Jira project keys
4. **Archive TestRail project** (after verification)

For more information, see:

- [README.md](README.md) - Main documentation
- [XRAY_API_REFERENCE.md](XRAY_API_REFERENCE.md) - API details
- [JIRA_SCREEN_CONFIG_GUIDE.md](JIRA_SCREEN_CONFIG_GUIDE.md) - Jira setup

---

**Happy migrating! ğŸš€**
